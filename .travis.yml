language:
  - c
compiler:
  - gcc
install:
  - sudo apt-get update
  - sudo apt-get install libsdl1.2-dev libxxf86vm-dev
  - sudo apt-get install mingw-w64 gcc-mingw-w64-base gcc-mingw-w64 binutils-mingw-w64
script:
  - make
  - ./cross-make-mingw.sh
cache:
  - apt
deploy:
  provider: releases
  api-key: "GITHUB OAUTH TOKEN"
  file:
    - build/release-linux-x86_64/Quake3-UrT-Ded.x86_64
    - build/release-linux-x86_64/Quake3-UrT.x86_64
    - build/release-mingw32-x86/Quake3-UrT-Ded.x86.exe
    - build/release-mingw32-x86/Quake3-UrT.x86.exe
  skip_cleanup: true
  on:
    tags: true
    all_branches: true
